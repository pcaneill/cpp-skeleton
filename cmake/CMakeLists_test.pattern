project (_PROJECT__test)

file (GLOB TESTS_SRC *.cpp)

add_executable (_PROJECT__test ${TESTS_SRC})
target_link_libraries (_PROJECT__test
  -Xlinker --whole-archive    _PROJECT_
  -Xlinker --no-whole-archive libgtest libgtest_main
)

add_test (
  NAME _PROJECT__test
  COMMAND _PROJECT__test
)
